!function(e){var t={};function o(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(s,n,function(t){return e[t]}.bind(null,n));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){o(2),e.exports=o(1)},function(e,t,o){},function(e,t,o){"use strict";o.r(t);var s={};o.r(s),o.d(s,"log",(function(){return i})),o.d(s,"$",(function(){return a})),o.d(s,"$$",(function(){return c})),o.d(s,"each",(function(){return l})),o.d(s,"merge",(function(){return u})),o.d(s,"dom",(function(){return d})),o.d(s,"script",(function(){return p})),o.d(s,"css",(function(){return g})),o.d(s,"locale",(function(){return m})),o.d(s,"xhr",(function(){return h}));let n=window,r=document;function i(){let e=new Date,t=Array.prototype.slice.apply(arguments);t.unshift(e.toLocaleTimeString()),console.log.apply(console,t)}function a(e){return r.querySelector(e)}function c(e){return r.querySelectorAll(e)}function l(e,t){if(e instanceof Array||e instanceof n.NodeList)e.forEach(t);else for(let o in e)t(o,e[o])}function u(e,t){l(t,(o,s)=>{e[o]instanceof Object||e[o]instanceof Array?u(e[o],t[o]):e[o]=s})}function d(e,t){let o=new RegExp("^(?:([^:]+):)?([^#.]+)(?:#([^.]+))?(?:.(.+))?$"),[s,i,a,c,u]=e.tag.match(o),p=r.createElement(a);return e.atts||(e.atts={}),c&&(e.atts.id=c),u&&(e.atts.class=u.replace(/\./g," ")),i&&(e.map=i),l(e.atts,(e,t)=>{p.setAttribute(e,t)}),e.html&&(p.innerHTML=e.html),l(e.evts||{},(e,t)=>{p.addEventListener(e,t,!0)}),l(e.child||[],e=>{e instanceof n.HTMLElement?p.appendChild(e):p.appendChild(d(e,t))}),e.map&&(t[e.map]=p),p}function p(e,t=!0,o=!0){if(!e)return null;let s=r.querySelector("script"),n=d({tag:"script",atts:{async:t,src:e}});return o?s.parentNode.insertBefore(n,s):(r.body||r.head).appendChild(n),n}function g(e,t,o){e.classList.toggle(t,o)}function m(e,t="en"){let o=!1;return l(navigator.languages,t=>{o||(!e[t]&&t.length>2&&(t=t.substr(0,2)),e[t]&&(o=t))}),o||t}function h(e,t="get",o=null){let s=new n.XMLHttpRequest;return new Promise((n,r)=>{s.addEventListener("load",()=>{n(s)}),s.addEventListener("error",()=>{r(s.status)}),"post"!==t&&o&&(e+="?"+o,o=null),s.open(t.toUpperCase(),e),s.withCredentials=!0,"post"===t&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(o)})}const f={msg:{first:"<p><strong>Nous respectons votre vie priv√©e</strong>, et c'est pourquoi nous ne collectons pour l'instant que des statistiques anonymis√©es de votre visite.</p><p>Vous pouvez continuer votre navigation ainsi (<strong>Discreto</strong>), <strong>Tout accepter</strong> ou d√©finir vos <strong>Pr√©f√©rences</strong>.</p>",dnt:"<p><strong>Nous respectons votre vie priv√©e, et vous avez activ√© l'option <em>Do Not Track</em></strong> de votre naviguateur, aussi aucun service n'a pour l'instant √©t√© activ√©.</p><p>Vous pouvez pour ce site autoriser la collecte de statistiques anonymis√©es (<strong>Discreto</strong>), <strong>Tout accepter</strong> ou d√©finir vos <strong>Pr√©f√©rences</strong>.</p>",prefs:"<p><strong>Choisissez les services que vous souhaitez activer sur ce site</strong>, puis cliquez sur <strong>Enregistrer</strong>.</p><p>Vous pouvez n'autoriser que les statistiques anonymis√©es (<strong>Anonyme</strong>), ou m√™me d√©sactiver tous les services (<strong>Invisible</strong>).</p>",cookie:"<p><strong>Vous avez activ√© {active} service(s)</strong> sur {total}. Cliquez sur <strong>Pr√©f√©rences</strong> pour modifier vos choix.</p>",anon:"<p><strong>Vous naviguez anonymement</strong>, avec {active} service(s) activ√©(s) sur {total}. Cliquez sur <strong>Pr√©f√©rences</strong> pour modifier vos choix.</p>",ghost:"<p><strong>Vous √™tes actuellement invisible</strong> et aucun service n'a √©t√© activ√©. Cliquez sur <strong>Pr√©f√©rences</strong> pour modifier vos choix.</p>",more:"<p><strong>Afin d'am√©liorer la qualit√© de nos services</strong>, nous avons ajout√© {more} service(s).</p><p>Vous pouvez le(s) <strong>Accepter</strong>, le(s) <strong>Refuser</strong> ou d√©finir vos <strong>Pr√©f√©rences</strong>.</p>",remote:"<p><strong>Vos pr√©f√©rences ont √©t√© reprises de vos choix pr√©c√©dents</strong>, avec {active} service(s) activ√©(s) sur {total}.</p><p>Vous pouvez <strong>Continuer</strong> ainsi, n'activer sur ce site que les statistiques anonymis√©es (<strong>Discreto</strong>), ou d√©finir vos <strong>Pr√©f√©rences</strong>.</p>",almost:"<p><strong>Vos pr√©f√©rences ont √©t√© reprises de vos choix pr√©c√©dents</strong>, mais {more} autre(s) service(s) sur ce site n√©cessite(nt) votre consentement.</p><p>Vous pouvez le(s) <strong>Accepter</strong>, le(s) <strong>Refuser</strong> ou d√©finir vos <strong>Pr√©f√©rences</strong>.</p>",error:"<p>Impossible de r√©cup√©rer les informations, veuillez r√©-essayer.</p>",thanks:'Merci <a target="_blank" href="https://discre.to">discreto</a> (<a target="_blank" href="https://discre.to/abuse">signaler un abus</a>)',undef:"<big>ü§ï</big><p>Aucun consentement n'est pr√©vu pour {title}, cette fen√™tre a √©t√© bloqu√©e&nbsp;:<br/>{src}</p>",choose:"<big>ü§î</big><p>Acceptez les conditions du service {title} pour afficher la fen√™tre&nbsp;:<br/>{src}</p>",block:"<big>ü§´</big><p>Vous avez choisi de bloquer les fen√™tres {title}</p>"},btns:{discreto:"Discreto",prefs:"Pr√©f√©rences",cognito:"Tout accepter",anonymous:"Anonyme",ghost:"Invisible",save:"Enregistrer",ok:"OK",allow:"Accepter",deny:"Refuser",keep:"Continuer",about:"√† propos",cookie:"en savoir plus",domains:"domaines",share:"en savoir plus",once:"Accepter",always:"Toujours accepter sur ce site",force:"Afficher tout de m√™me"},options:{cookie:"Cookie de consentement",domains:"Appliquer pour tous nos domaines",share:"Enregistrer mes choix sur discre.to"},about:{unknown:"<p>La description de ce service est manquante, veuillez le signaler au webmaster du site.</p>",_discreto:"<p>Afin de se souvenir de vos choix, un cookie est d√©pos√© dans votre navigateur. Il ne contient aucune information personnelle vous concernant.</p><p>Ce cookie, nomm√© <code>{name}</code>, est valable {days} jours.</p><p><strong>Ce service est indispensable et ne peut √™tre d√©sactiv√©.</strong></p>"},types:{audience:"Mesure d'audience",social:"Partage et r√©seaux sociaux",media:"Lecteurs audio/vid√©o",reader:"Lecteurs de document",ads:"Ciblage publicitaire",comments:"Commentaires",misc:"Divers",advanced:"Options"},services:{"analytics-anon":"Google Analytics (anonymis√©)",analytics:"Google Analytics","analyticsGA-anon":"Google Analytics (anonymis√©)",analyticsGA:"Google Analytics","matomo-anon":"Matomo (anonymis√©)",matomo:"Matomo",koban:"Koban",mautic:"Mautic",facebookPixel:"Facebook Pixel",twitterPixel:"Twitter Pixel",xiti:"Xiti","xiti-anon":"Xiti (anonymis√©)",addthis:"AddThis",addtoany:"AddToAny",sharethis:"ShareThis","dailymotion-api":"Dailymotion (API)",dailymotion:"Dailymotion (embed)","vimeo-api":"Vimeo (API)",vimeo:"Vimeo (embed)","youtube-api":"YouTube (API)",youtube:"YouTube (embed)","soundcloud-api":"SoundCloud (API)",soundcloud:"SoundCloud (embed)",calameo:"Calameo",issuu:"Issuu",prezi:"Prezi",slideshare:"Slideshare","adsense-optout":"AdSense (sans ciblage)",adsense:"AdSense",adwords:"AdWords",amazonAds:"Amazon",criteo:"Criteo",microsoftAds:"Microsoft Advertising (ex Bing Ads)",twitterAds:"Twitter Ads",facebook:"Partage Facebook",linkedin:"Partage LinkedIn",twitter:"Partage Twitter",pinterest:"Partage Pinterest",disqus:"Commentaires Disqus",facebookComments:"Facebook Comments","googleMaps-api":"Google Maps (API)",googleMaps:"Google Maps (embed)",googleFonts:"Google Fonts",typekit:"TypeKit",recaptcha:"Google ReCaptcha (v3)",recaptchaV2:"Google ReCaptcha (v2)"}},v={msg:{first:"<p><strong>We respect your privacy</strong>, which is why we only collect anonymized statistics of your visit at this time.</p><p>You can continue browsing this way ((<strong>Discreto</strong>)), <strong>Accept all</strong> services or set your <strong>Preferences</strong>.</p>",dnt:"<p><strong>We respect your privacy, and you have activated the <em>Do Not Track</em> option of your browser</strong>, so no service has yet been enabled.</p><p>You can authorize anonymized statistics of your visit on this site (<strong>Discreto</strong>), <strong>Accept all</strong> or set your <strong>Pr√©f√©rences</strong>.</p>",prefs:"<p><strong>Choose the services you want to enable on this site</strong>, then click <strong>Save</strong>.</p><p>You can allow anonymized statistics only (<strong>Anonymous</strong>), or even disable all services (<strong>Invisible</strong>).</p>",cookie:"<p><strong>You have enabled {active} service(s)</strong> out of {total}. Click <strong>Preferences</strong> to modify your choices.</p>",anon:"<p><strong>Vous are currently browsing anonymously</strong>, with {active} service(s) enabled out of {total}. Click <strong>Preferences</strong> to modify your choices.</p>",ghost:"<p><strong>You are currently invisible</strong> with no service enabled. Click <strong>Preferences</strong> to modify your choices.</p>",more:"<p><strong>In order to improve the quality of our services</strong>, we have added {more} service(s).</p><p>You can <strong>Accept</strong> or <strong>Refuse</strong> them or set your <strong>Preferences</strong>.</p>",remote:"<p><strong>Your preferences have been retrieved from your previous choices</strong>, avec {active} service(s) enabled out of {total}.</p><p>You can <strong>Continue</strong> like this, allow only anonymous statistics of your visit on this site (<strong>Discreto</strong>), or set your <strong>Preferences</strong>.</p>",almost:"<p><strong>Your preferences have been retrieved from your previous choices</strong>, but {more} other service(s) on this site require(s) your consent.</p><p>You can <strong>Accept</strong> or <strong>Refuse</strong> them, or set your <strong>Preferences</strong>.</p>",error:"<p>Cannot gather information about this service, please try again later.</p>",thanks:'Thank you <a target="_blank" href="https://discre.to">discreto</a> (<a target="_blank" href="https://discre.to/abuse">report abuse</a>)',undef:"<big>ü§ï</big><p>No consent has been asked for {title}, this window has been blocked:<br/>{src}</p>",choose:"<big>ü§î</big><p>Please accept {title} terms of service to show this window:<br/>{src}</p>",block:"<big>ü§´</big><p>You've chosen to block {title} windows</p>"},btns:{discreto:"Discreto",prefs:"Preferences",cognito:"Accept all",anonymous:"Anonymous",ghost:"Invisible",save:"Save",ok:"OK",allow:"Accept",deny:"Refuse",keep:"Continue",about:"about",cookie:"learn more",domains:"domains",share:"learn more",once:"Accept",always:"Always accept on this site",force:"Accept anyway"},options:{cookie:"Consent cookie",domains:"Apply for all our domains",share:"Save my preferences on discre.to"},about:{unknown:"<p>This service has no description yet, please report it to the webmaster.</p>",_discreto:"<p>In order to remember your choices on this device, a cookie is stored in your browser. It doesn't contain any personal information about you.</p><p>This cookie is named <code>{name}</code>, and is valid for {days} jours.</p><p><strong>This service is essential and cannot be disabled.</strong></p>"},types:{audience:"Audience measurement",social:"Share and social networks",media:"Media players",reader:"Document viewers",ads:"Advertising targeting",comments:"Comments",misc:"Miscellaneous",advanced:"Options"},services:{"analytics-anon":"Google Analytics (anonymized)",analytics:"Google Analytics","analyticsGA-anon":"Google Analytics (anonymized)",analyticsGA:"Google Analytics","matomo-anon":"Matomo (anonymized)",matomo:"Matomo",koban:"Koban",mautic:"Mautic",facebookPixel:"Facebook Pixel",twitterPixel:"Twitter Pixel",xiti:"Xiti","xiti-anon":"Xiti (anonymized)",addthis:"AddThis",addtoany:"AddToAny",sharethis:"ShareThis","dailymotion-api":"Dailymotion (API)",dailymotion:"Dailymotion (embed)","vimeo-api":"Vimeo (API)",vimeo:"Vimeo (embed)","youtube-api":"YouTube (API)",youtube:"YouTube (embed)","soundcloud-api":"SoundCloud (API)",soundcloud:"SoundCloud (embed)",calameo:"Calameo",issuu:"Issuu",prezi:"Prezi",slideshare:"Slideshare","adsense-optout":"AdSense (no targeting)",adsense:"AdSense",adwords:"AdWords",amazonAds:"Amazon",criteo:"Criteo",microsoftAds:"Microsoft Advertising (ex Bing Ads)",twitterAds:"Twitter Ads",facebook:"Share on Facebook",linkedin:"Share on LinkedIn",twitter:"Share on Twitter",pinterest:"Share on Pinterest",disqus:"Disqus comments",facebookComments:"Facebook Comments","googleMaps-api":"Google Maps (API)",googleMaps:"Google Maps (embed)",googleFonts:"Google Fonts",typekit:"TypeKit",recaptcha:"Google ReCaptcha (v3)",recaptchaV2:"Google ReCaptcha (v2)"}},b={fr:f,en:v},y={debug:!1,gui:{pos:"left",logo:!1,block:!1,urge:!1,css:!1,lang:"fr"},cookie:{name:"discreto",days:365,path:"/",wild:!1,share:!1,url:"https://cookie.discre.to"},ids:{},services:{}},k={};let w=window,A=document;k.nil={},k.script={start:e=>{e.forEach(e=>{let t=A.createElement("script");t.setAttribute("async",!0),t.src=e,k.box.appendChild(t)})}},k.html={init:e=>(e&&(k.html.box=A.getElementById(e)),k.html.box||(k.html.box=k.box),null),start:e=>{e.forEach(e=>{let t=A.createElement("template"),o=A.createElement("div"),s=[];e=e.replace(/<script>(.*)<\/script>/g,(e,t)=>(s.push(t),"")),t.innerHTML=e,o.appendChild(t.content),s.forEach(e=>{let t=A.createElement("script");t.innerHTML=e,o.appendChild(t)}),k.html.box.appendChild(o)})}},k.iframe={frames:[],init:e=>(k.iframe.template=A.createElement("iframe"),k.iframe.template.className="noscript",null),start:e=>{e.forEach(e=>{let t=k.iframe.template.cloneNode(!0);t.src=e,k.iframe.frames.push(t),k.box.appendChild(t)})},send:e=>{k.iframe.frames.forEach(t=>{t.contentWindow.postMessage(e,"*")})}},k.gtm={init:e=>{let t=(new Date).getTime();return w.dataLayer=w.dataLayer=[],w.dataLayer.push({event:"gtm.js","gtm.start":t}),w.gtag||(w.gtag=function(){w.dataLayer.push(arguments)}),"https://www.googletagmanager.com/gtm.js?id="+e},start:e=>{w.dataLayer.push({event:"discreto",service:"|"+e.join("|")+"|"})}},k.gtag={anon:!1,init:(e,t)=>{if(t&&(k.gtag.anon=!0),w.gtag)return null;return w.dataLayer=w.dataLayer||[],(w.gtag=function(){w.dataLayer.push(arguments)})("js",new Date),"https://www.googletagmanager.com/gtag/js?id="+e},start:e=>{e.forEach(e=>{let t=k.gtag.anon?{anonymize_ip:!0}:{};w.gtag("config",e,t)})}},k.analyticsGA={init:(e,t)=>{if(w.ga)return null;w.GoogleAnalyticsObject="ga";let o=w.ga=function(){o.q.push(arguments)};return o.q=[],o.l=1*new Date,o("create",e,"auto"),t&&o("set","anonymizeIp",!0),"https://www.google-analytics.com/analytics.js"},start:e=>{e.forEach(e=>w.ga("send",e))}},k.analytics={init:k.gtag.init,start:k.gtag.start},k.matomo={init:(e,t)=>{let o=w._paq=w._paq||[];return o.push(["setTrackerUrl",e.url+"matomo.php"]),o.push(["setSiteId",e.id]),"/"!==e.url.charAt(e.url.length-1)&&(e.url+="/"),e.url+"piwik.js"},start:e=>{e.forEach(e=>w._paq.push(e))}},k.facebookPixel={std:["AddPaymentInfo","AddToCart","AddToWishlist","CompleteRegistration","Contact","CustomizeProduct","Donate","FindLocation","InitiateCheckout","Lead","Purchase","Schedule","Search","StartTrial","SubmitApplication","Subscribe","ViewContent"],init:e=>{if(w.fbq)return null;let t=w.fbq=function(){t.callMethod?t.callMethod.apply(t,arguments):t.queue.push(arguments)};return w._fbq||(w._fbq=t),t.push=t,t.loaded=!0,t.version="2.0",t.queue=[],t("init",e),"https://connect.facebook.net/en_US/fbevents.js"},start:e=>{e.forEach(e=>{let t=k.facebookPixel.std.includes(e);w.fbq(t?"track":"trackCustom",e)})}},k.mautic={init:e=>{if(w.mt)return null;w.MauticTrackingObject="mt";let t=w.mt=function(){t.q.push(arguments)};return t.q=[],"/"!==e.charAt(e.length-1)&&(e+="/"),e+"mtc.js"},start:e=>{e.forEach(e=>w.mt("send",e))}},k.twitterPixel={init:e=>{if(w.twq)return null;var t=w.twq=()=>{t.exe?t.exe.apply(t,arguments):t.queue.push(arguments)};return t.version="1.1",t.queue=[],t("init",e),"//static.ads-twitter.com/uwt.js"},start:e=>{e.forEach(e=>w.twq("track",e))}},k.xiti={init:e=>{let t,o,s="s="+e+"&p="+encodeURIComponent(A.location.pathname),n=new Date,r=w.screen;try{o=top.document.referrer}catch(e){o=document.referrer}return s+="&hl="+n.getHours()+"x"+n.getMinutes()+"x"+n.getSeconds(),parseFloat(navigator.appVersion)>=4&&(s+="&r="+r.width+"x"+r.height+"x"+r.pixelDepth+"x"+r.colorDepth),s+="&ref="+o.replace(/[<>"]/g,"").replace(/&/g,"$"),t=new Image(39,25),t.src="http://logv2.xiti.com/hit.xiti?"+s,null}},k.facebook={init:(e,t=!1)=>{let o=A.createElement("div"),s=t?"5.0":"3.0";return o.id="fb-root",A.body.appendChild(o),{crossorigin:"anonymous",id:"facebook-jssdk",src:"https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v"+s+"&appId="+e}}},k.linkedin={init:()=>"https://platform.linkedin.com/in.js"},k.pinterest={init:()=>"//assets.pinterest.com/js/pinit.js"},k.twitter={init:()=>"https://platform.twitter.com/widgets.js"},k.addthis={init:e=>"http://s7.addthis.com/js/300/addthis_widget.js#domready=1&pubid="+e,start:()=>w.addthis.init()},k.addtoany={init:()=>"https://static.addtoany.com/menu/page.js",start:()=>w.a2a.init_all()},k.sharethis={init:e=>"//platform-api.sharethis.com/js/sharethis.js#property="+e+"&product=custom-share-buttons"},k.dailymotion={init:()=>"https://api.dmcdn.net/all.js"},k.vimeo={init:()=>"https://player.vimeo.com/api/player.js"},k.youtube={init:()=>"https://www.youtube.com/iframe_api"},k.soundcloud={init:()=>"https://w.soundcloud.com/player/api.js"},k.adsense={init:(e,t)=>{var o=w.adsbygoogle=w.adsbygoogle||[];return o.push({google_ad_client:"ca-"+e,enable_page_level_ads:!0}),t&&(o.requestNonPersonalizedAds=1),"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"}},k.adwords={init:k.gtag.init,start:k.gtag.start},k.amazonAds={init:()=>"//z-na.amazon-adsystem.com/widgets/onejs"},k.criteo={init:()=>{w.criteo_q=w.criteo_q||[];return"//static.criteo.net/js/ld/ld.js"}},k.microsoftAds={init:e=>{w.uetq=w.uetq||[];return k.microsoftAds.id=e,"//bat.bing.com/bat.js"},start:e=>{var t={ti:k.microsoftAds.id,q:w.uetq};w.uetq=new UET(t),e.forEach(e=>w.uetq.push(e))}},k.disqus={init:e=>(w.disqus_config=function(){this.page.url=A.location.href,this.page.identifier=A.location.pathname},{"data-timestamp":+new Date,src:"https://"+e+".disqus.com/embed.js"}),start:e=>{let t=A.createElement("div");t.id="disqus_thread",A.getElementById(e[0]).appendChild(t)}},k.googleMaps={init:e=>"https://maps.googleapis.com/maps/api/js?key="+e},k.recaptcha={init:e=>"https://www.google.com/recaptcha/api.js?render="+e},k.recaptchaV2={init:()=>"https://www.google.com/recaptcha/api.js"
/*!    _ _                 _
 *  __| (_)___ __ _ _ ___ | |_ ___
 * / _` | (_-</ _| '_/ -_)|  _/ _ \
 * \__,_|_/__/\__|_| \___(_)__\___/
 *
 * Copyright ¬© 2020 - MIT License
 * Greg Deback <greg@discre.to>
 * <https://discre.to>
 */};const x="first",P="cookie",C="more",j="remote",q="almost",T="prefs",_=[P,j],z={first:"discreto|prefs|cognito",cookie:"prefs|ok",remote:"discreto|prefs|keep",more:"deny|prefs|allow",almost:"deny|prefs|allow",prefs:"anonymous|ghost|save"},E={ghost:()=>U(!1),anonymous:()=>U(null),discreto:()=>U(null)&&J(),cognito:()=>U(!0)&&J(),allow:()=>B(!0)&&J(),deny:()=>B(!1)&&J(),save:()=>J(),keep:()=>J(),prefs:()=>Y(),cancel:()=>Y(!1),show:()=>N(),ok:()=>N(!1)};let S,M,L=window,D=document,I={dnt:!1,lang:null,mode:null,popup:!1,show:!1,prefs:{},tags:{},level:1,proms:[],ban:!1};function G(){if(!L.discretoConf)return Promise.resolve(!1);if("string"==typeof L.discretoConf){let e=L.discretoConf.match(/^gtm:\/\/([^\/]+)\/(.+)$/);return e?(we("config: gtm"),$(e[1],e[2])):(we("config: json"),h(L.discretoConf).then(e=>{if(200!==e.status)return Promise.reject(e.status);let t=JSON.parse(e.responseText);return t?O(t):Promise.reject(400)}))}return O(L.discretoConf)}function O(e){return u(y,e),u(b,L.discretoLocale||{}),I.lang=m(b,y.gui.lang),M=b[I.lang],we("lang:",I.lang),I.dnt="1"===L.navigator.doNotTrack,y.cookie.dnt&&(I.dnt=!0),L.addEventListener("message",F),we("start"),ae().then(ce).then(()=>ve().then(()=>ie(P,C),()=>oe().then(()=>ie(j,q),()=>Promise.resolve(x))).then(te).then(ye)).catch(e=>{console.error("[discreto] loading failed, check config & locale"),we(e)})}function V(){S.box.parentNode.removeChild(S.box),delete S.box,I.mode=null,I.popup=!1,I.show=!1,I.prefs={},I.tags={},I.level=1,I.proms=[]}function R(e){return new Promise((t,o)=>{if("*"===e.charAt(e.length-1)){let s,n=new RegExp("^"+e+"($|-)"),r=Object.keys(y.services).filter(e=>e.match(n)),i=r.filter(e=>I.prefs[e]);return r.length?i.length?t(i):_.includes(I.mode)?o(null):(s=r.map(e=>R(e).catch(()=>Promise.resolve(null))),Promise.all(s).then(e=>e.filter(e=>I.prefs[e])).then(e=>e.length?t(e):o(null))):o(null)}return I.prefs[e]?t(e):_.includes(I.mode)?o(null):I.proms.push({name:e,resolve:t,reject:o})})}function N(e=!0){return I.popup!==e&&(e||Y(!1),I.popup=e,g(S.box,"min",!e),!0)}function Y(e=!0){return e?(N(),pe(T)):pe(I.mode),e&&(I.mode===x?U(!!y.gui.urge||null):I.mode!==P&&B(!!y.gui.urge||null)),I.show!==e&&(I.show=e,g(S.box,"show",e)),!0}function $(e,t){return ke("gtm",{id:e,args:[t]}),Promise.resolve()}function F(e){let t=e.data,o=t.discreto;o&&(!0!==o?(t.force?I.prefs[o]=t.on:fe(o,t.on),t.force||t.once?ye(!0):J(!0)):Y())}function H(){return we("refresh"),l(I.prefs,fe),!0}function U(e,t=!1){return we(t?"more:":"select:",e),l(y.services,(o,s)=>{t&&void 0!==I.prefs[o]||"_share"!==o&&fe(o,null===e?!!s.anon:e)}),!0}function B(e){return U(e,!0)}function K(e){return fe(e.target.name,e.target.checked)}function W(e){let t=e.target.parentNode,o=e.target.getAttribute("data-name"),s="_discreto"===o?y.cookie:y.services[o];if(s){if(s.info)return we("toggle:",o),void g(s.info,"rolled");s.info=d({tag:"div.info.rolled"}),t.parentNode.insertBefore(s.info,t.nextSibling),we("info:",o),X(o,s).then(e=>{e=e.replace(/{([^}]+)}/g,(e,t)=>y.cookie[t]||t),s.info.innerHTML="<div>"+e+"</div>",setTimeout(()=>g(s.info,"rolled",!1),20)})}else we("unknown:",o)}function X(e,t){let o,s=y.cookie.url,n=t.about;return"_wild"===e?(o=y.cookie.wild.map(e=>"<li>"+e+"</li>"),Promise.resolve("<ul>"+o.join("")+"</ul>")):M.about&&M.about[e]?Promise.resolve(M.about[e]):n?(n instanceof Object&&(n=n[I.lang]||n[y.gui.lang]||M.unknown),Promise.resolve(n)):(we("feed:",e),h(s+"/"+I.lang+"/"+e).then(e=>e.responseText).catch(()=>Promise.resolve(M.msg.error)))}function J(e=!1){return we("save"),l(I.prefs,(e,t)=>{let o=y.services[e];t&&o&&l(o.excl||[],e=>{I.prefs[e]=!1})}),te(P),ye(!0),be(),e||se(),N(!1),!0}function Q(){let e=I.proms;we("resolve"),I.proms=[],l(c("[data-discreto]"),Z),l(e,e=>{let t=e.name;void 0===I.prefs[t]?I.proms.push(e):I.prefs[t]?e.resolve(t):e.reject(null)}),l(I.prefs,(e,t)=>{let o=new L.CustomEvent("discreto-"+e,{detail:t}),s=new L.CustomEvent("discreto",{detail:{name:e,on:t}});D.dispatchEvent(o),D.dispatchEvent(s)})}function Z(e){let t,o=e.tagName.toLowerCase(),s=e.getAttribute("data-src"),n=e.getAttribute("data-class"),r=e.getAttribute("data-discreto");if("*"===r.charAt(r.length-1)){let e=new RegExp("^"+r+"($|-)");t=!!Object.keys(I.prefs).filter(t=>t.match(e)).filter(e=>I.prefs[e]).length,r=r.substr(0,r.length-1)}else t=I.prefs[r];if(t)return we("enabled:",s||o),void(s?(e.removeAttribute("data-discreto"),e.src=s):g(e,n,!0));we("disabled:",s||o),s||g(e,n,!1),"iframe"===o&&ee(e,r,s)}function ee(e,t,o){let s,n,r=y.services[t],i=M.services[t]||t,a="javascript:window.parent.postMessage";r&&r.name&&(i=r.name,i instanceof Object&&(i=i[I.lang]||i[y.gui.lang]||t)),r?s=_.includes(I.mode)?"block":"choose":(we("no pref:",t),s="undef"),n='<!doctype html><html><head><style>html,body{height:100%;margin:0;padding:0}body{display:flex;background-image:linear-gradient(135deg,whitesmoke 25%,white 25%,white 50%,whitesmoke 50%,whitesmoke 75%,white 75%,white 100%,whitesmoke 100%);background-size:60px 60px;justify-content:center;align-items:center;color:black;text-align:center;font:300 14px/1.4 "Helvetica Neue",Helvetica,Arial,sans-serif}big{font-size:3em}a{text-decoration:none;font-weight:600;color:inherit}</style></head><body><div>',n+=M.msg[s].replace("{title}",i).replace("{src}",o),n+=r?'<a href="'+a+"({ discreto: '"+t+"', on: true, once: true }, '*')\">"+M.btns.once+'</a> | <a href="'+a+"({ discreto: '"+t+"', on: true }, '*')\">"+M.btns.always+"</a> | ":'<a href="'+a+"({ discreto: '"+t+"', on: true, force: true }, '*')\">"+M.btns.force+"</a> | ",n+='<a href="'+a+"({ discreto: true }, '*')\">"+M.btns.prefs+"</a>",n+="</div></body></html>",e.setAttribute("src","data:text/html;charset=UTF-8,"+n)}function te(e){we("mode:",e),I.mode=e,pe(e),de(e),H(),e===x&&U(!I.dnt&&null),e===q&&B(!I.dnt&&null),_.includes(e)||N()}function oe(){return y.cookie.share?(g(S.box,"spring",!0),h(y.cookie.url).then(e=>(we("fetch:",e.status),200!==e.status?(403===e.status&&ge(e.responseText),Promise.reject()):(ne(e.responseText),!0))).finally(()=>g(S.box,"spring",!1))):Promise.reject()}function se(){let e="mask="+re()+"&days="+y.cookie.days;return y.cookie.share&&I.prefs._share?h(y.cookie.url,"post",e).then(e=>(we("post:",e.status),201===e.status||(403===e.status&&ge(e.responseText),Promise.reject(e)))).catch(e=>{console.error("[discreto] could not post shared preferences"),we(e)}):Promise.resolve(!1)}function ne(e){""!==e&&l(e.split("|"),e=>{let t="-"!==e.charAt(0);t||(e=e.substr(1)),y.services[e]&&(I.prefs[e]=t)})}function re(){let e=[];return l(I.prefs,(t,o)=>{e.push((o?"":"-")+t)}),e.join("|")}function ie(e,t){let o,s=Object.keys(I.prefs);return o=Object.keys(y.services).filter(e=>"_share"!==e&&!s.includes(e)),o.length?(l(o,e=>{l(S.items[e],e=>{g(e.box,"new",!0)})}),Promise.resolve(t)):Promise.resolve(e)}function ae(){let e,t=y.gui.css;return null===t?Promise.resolve():(!1===t&&l(c("script"),e=>{e.src&&e.src.match(/\/discreto(\.min)?\.js(\?|$)/)&&(t=e.src.replace(/\.js(\?|$)/,".css$1"))}),new Promise((o,s)=>{e=d({tag:"link",atts:{rel:"stylesheet",href:t}}),e.addEventListener("load",o,!0),e.addEventListener("error",s,!0),a("head").appendChild(e)}))}function ce(){return S={},d({tag:"box:aside#discreto.min",evts:{click:E.show},child:[{tag:"div.overlay"},{tag:"div.popup",child:[{tag:"form:form.consent",child:[{tag:"logo:div.logo"},{tag:"head:div.head"},{tag:"prefs:div.prefs",child:[{tag:"div.item",child:[{tag:"label",child:[{tag:"input",atts:{type:"checkbox",checked:"checked",disabled:"disabled"}},{tag:"span",html:M.options.cookie}]},{tag:"i",atts:{"data-name":"_discreto"},evts:{click:W},html:M.btns.cookie}]},{tag:"foot:p.credits",html:M.msg.thanks}]},{tag:"btns:nav.btns",child:[{tag:"front:div.front"},{tag:"back:div.back"}]}]}]}]},S),I.dnt&&g(S.box,"dnt",!0),y.gui.block&&g(S.box,"block",!0),y.gui.pos&&g(S.box,y.gui.pos,!0),y.gui.logo&&S.logo.appendChild(d({tag:"img",atts:{src:y.gui.logo}})),de(T),y.cookie.wild&&(y.services._wild={name:M.options.domains,btn:M.btns.domains,types:["advanced"],anon:!0}),y.cookie.share&&(y.services._share={name:M.options.share,btn:M.btns.share,types:["advanced"]}),S.items={},l(y.services,ue),k.box=S.box,D.body.appendChild(S.box),Promise.resolve()}function le(e){d({tag:e+":fieldset.field."+e,child:[{tag:"legend",html:M.types[e]}]},S),S.prefs.insertBefore(S[e],S.foot)}function ue(e,t){S.items[e]||(S.items[e]=[]),l(t.types,(o,s)=>{S[o]||le(o);let n={},r=t.name||M.services[e]||e;r instanceof Object&&(r=r[I.lang]||r[y.gui.lang]||e),d({tag:"box:div.item",child:[{tag:"label",child:[{tag:"check:input",evts:{change:K},atts:{type:"checkbox",name:e}},{tag:"span",html:r}]},{tag:"i",evts:{click:W},atts:{class:s?"none":"","data-name":e},html:t.btn||M.btns.about}]},n),S.items[e].push(n),S[o].appendChild(n.box)})}function de(e){let t=z[e].split("|"),o=S[e===T?"back":"front"];for(;o.firstChild;)o.firstChild.remove();l(t,e=>{o.appendChild(d({tag:"button",atts:{type:"button"},evts:{click:E[e]},html:M.btns[e]}))})}function pe(e){let t=M.msg[e],o=!0,s=!0,n=he();e===x&&I.dnt&&(t=M.msg.dnt),e===P&&(l(I.prefs,(e,t)=>{let n=y.services[e];n&&(s&=!t,"_wild"!==e&&"_share"!==e&&(o&=!t||n.anon))}),s?t=M.msg.ghost:o&&(t=M.msg.anon)),t=t.replace(/{([^}]+)}/g,(e,t)=>n[t]),S.head.innerHTML=t}function ge(e){let t=d({tag:"div.info.misuse",html:e});S.advanced.appendChild(t),S.items._share[0].check.disabled=!0,fe("_share",!1),I.ban=!0}function me(){let e=he(),t=Math.ceil(5*e.active/e.total);t!==I.level&&(g(S.box,"cognito"+t,!0),g(S.box,"cognito"+I.level,!1),I.level=t)}function he(){let e,t=Object.keys(I.prefs),o=Object.keys(y.services),s=t.filter(e=>I.prefs[e]);return e=o.filter(e=>"_share"!==e&&!t.includes(e)),{total:o.length,active:s.length,more:e.length}}function fe(e,t){let o=y.services[e];return o?!!S.items[e]&&(("_share"!==e||!I.ban)&&(I.prefs[e]=t,l(S.items[e],e=>{e.check.checked=t}),l(o.excl||[],e=>{l(S.items[e],o=>{o.check.disabled=t,o.check.checked=!t&&I.prefs[e]})}),me(),!0)):(we("unknown:",e),!1)}function ve(){let e=y.cookie.name,t=new RegExp("(?:(?:^|.*;\\s*)"+e+"\\s*=\\s*([^;]*).*$)|^.*$"),o=D.cookie.match(t);return void 0===o[1]?Promise.reject():(ne(o[1]),Promise.resolve())}function be(){let e=y.cookie.name,t=e+"="+re(),o=new Date,s=e+"=",n=new Date,r=y.cookie.path||"/",i=D.location.hostname,a=i.replace(/^(?:.+\.)?([^\.]+\.[^\.]+)$/,"$1");return i="."+i,n.setDate(n.getDate()-1),s+=";path="+r,s+=";expires="+n.toUTCString(),D.cookie=s+";domain="+i,y.cookie.wild&&(D.cookie=s+";domain="+a),o.setDate(o.getDate()+y.cookie.days),t+=";path="+r,t+=";expires="+o.toUTCString(),t+=";domain="+(I.prefs._wild?a:i),D.cookie=t,we("write:",t),Promise.resolve()}function ye(e=!1){let t={};return l(I.prefs,(o,s)=>{let n,r=y.services[o];s&&r&&r.tag&&(t[r.tag]||(t[r.tag]={args:[],cmds:[],anon:!1}),n=t[r.tag],n.anon|=r.anon,r.cmd&&n.cmds.push(r.cmd),e&&r.save?l(r.save.split(","),e=>n.args.push(e.trim())):r.load&&l(r.load.split(","),e=>n.args.push(e.trim())))}),l(t,ke),Q(),Promise.resolve(!0)}function ke(e,t){let o,s,n=k[e],r=t.id||y.ids[e];if(n){if(!n.on){if(we("append:",e),n.init){try{o=n.init(r,t.anon)}catch(t){we("init failed:",e,t),o=null}o&&("string"==typeof o&&(o={src:o}),s=p(o.src),l(o,(e,t)=>{"src"!==e&&s.setAttribute(e,t)}))}n.on=!0,n.sent=[]}if(l(t.cmds,e=>e(r)),t.args=t.args.filter(e=>!n.sent.includes(e)),t.args.length)try{n.start&&n.start(t.args),n.sent.push.apply(n.sent,t.args)}catch(t){we("start failed:",e,t)}}else we("missing:",e)}function we(...e){y.debug&&(e.unshift("[discreto]"),i.apply(s,e))}L.discreto={start:O,clean:V,when:R,prefs:Y,popup:N,mode:te,conf:y,state:I},L.addEventListener("load",G,!0)}]);